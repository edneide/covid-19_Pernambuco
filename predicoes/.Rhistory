estados_data$state <- factor(estados_data$state, levels = c("SP", "RJ", "CE", "DF", "RS", "PE"))
library(ggplot2)
plot_comp <- ggplot(estados_data, aes(x = date, y = totalCases, group = state)) +
geom_line(aes(color = state), size = 1) +
geom_point(aes(color = state), size = 1) +
xlab("") +
labs(title = "Casos confirmados COVID-19",
subtitle = "Alguns estados do Brasil",
caption = paste("IRRD/PE. Fonte: Plataforma IVIS. \nDados atualizados em ",
format(as.Date(today()), "%d/%m/%Y"))) +
theme(legend.title=element_blank())+
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-12", today())))
plot_comp
jpeg(paste(path, "covid-19_comparativo_brasil.jpg", sep = ""),
width = 5, height = 4, units = 'in', res = 300)
plot_comp +
scale_y_continuous(breaks = seq(0,max(estados_data$totalCases),1000)) +
ylab("Casos confirmados\n(escala linear)")
dev.off()
jpeg(paste(path, "covid-19_comparativo_brasil_escala_log.jpg", sep = ""),
width = 5, height = 4, units = 'in', res = 300)
plot_comp + scale_y_continuous(trans = 'log10') +
ylab("Casos confirmados\n(escala log)")
dev.off()
library(readr)
library(dplyr)
library(tidyverse)
library(reshape2)
confirmedCases= read_csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv')
deathCases= read_csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv')
recoveredCases= read_csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv')
#convert data sets into columns and remove unwanted columns
confirmedCases<-confirmedCases%>%select(-c(Lat,Long))%>%melt(id=c('Country/Region','Province/State'))
confirmedCases<-confirmedCases%>%group_by(`Country/Region`,variable)%>%summarise(Confirmed=sum(value))
deathCases<-deathCases%>%select(-c(Lat,Long))%>%melt(id=c('Country/Region','Province/State'))
deathCases<-deathCases%>%group_by(`Country/Region`,variable)%>%summarise(Deaths=sum(value))
recoveredCases<-recoveredCases%>%select(-c(Lat,Long))%>%melt(id=c('Country/Region','Province/State'))
recoveredCases<-recoveredCases%>%group_by(`Country/Region`,variable)%>%summarise(Recovered=sum(value))
# rename table columns
colnames(confirmedCases)<-c("Country","Date","Confirmed")
colnames(deathCases)<-c("Country","Date","Death")
colnames(recoveredCases)<-c("Country","Date","Recovered")
# merge all atbles together
mergedCases<-merge(confirmedCases,deathCases, by.y=c("Country","Date"))
mergedCases<-merge(mergedCases,recoveredCases, by.y=c("Country","Date"))
library(readr)
library(dplyr)
library(tidyverse)
library(reshape2)
confirmedCases= read_csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv')
deathCases= read_csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv')
recoveredCases= read_csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv')
#convert data sets into columns and remove unwanted columns
confirmedCases<-confirmedCases%>%select(-c(Lat,Long))%>%melt(id=c('Country/Region','Province/State'))
confirmedCases<-confirmedCases%>%group_by(`Country/Region`,variable)%>%summarise(Confirmed=sum(value))
deathCases<-deathCases%>%select(-c(Lat,Long))%>%melt(id=c('Country/Region','Province/State'))
deathCases<-deathCases%>%group_by(`Country/Region`,variable)%>%summarise(Deaths=sum(value))
recoveredCases<-recoveredCases%>%select(-c(Lat,Long))%>%melt(id=c('Country/Region','Province/State'))
recoveredCases<-recoveredCases%>%group_by(`Country/Region`,variable)%>%summarise(Recovered=sum(value))
# rename table columns
colnames(confirmedCases)<-c("Country","Date","Confirmed")
colnames(deathCases)<-c("Country","Date","Death")
colnames(recoveredCases)<-c("Country","Date","Recovered")
# merge all atbles together
mergedCases<-merge(confirmedCases,deathCases, by.y=c("Country","Date"))
mergedCases<-merge(mergedCases,recoveredCases, by.y=c("Country","Date"))
brasil <- filter(mergedCases, Country == "Brazil")
brasil1 <- brasil
#brasil1[69,][c(3,4)] <- c(4630, 163)
brasil1 = brasil1 %>%
mutate(date2 = as.POSIXct(as.character(Date), format = "%m/%d/%y"),
date3 = as.Date(date2))
library(dplyr)
brasil1 = arrange(brasil1, Date)
brasil1$pais = rep("Brasil", dim(brasil1)[1])
library(ggplot2)
p <- ggplot(brasil1, aes(x = date3, y = Confirmed, group = pais)) +
geom_line(aes(color = pais), size = 1) +
scale_color_manual(values = c("#ff5050")) +
geom_point(aes(color = pais), size = 1.5) +
theme_light() +
theme(axis.text.x = element_text(angle = 90)) #+
#scale_y_continuous(breaks = seq(0, 1200, 100))
brasil_plot <- p + scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-08", today()))) +
xlab("") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
labs(title = "Casos confirmados COVID-19",
subtitle = "Brasil",
caption = paste("IRRD/PE. Fonte: CIEVS/NUVRESP/SEVS/SES.
\n Dados atualizados em ", format(today(), "%d/%m/%Y.")))
brasil_plot
jpeg(paste(path, "covid-19_confirmados_brasil.jpg"),
width = 4, height = 4, units = 'in', res = 300)
brasil_plot +
ylab("Total de casos confirmados\n(escala linear)")
dev.off()
jpeg(paste(path, "covid-19_confirmados_brasil_escala_log.jpg"),
width = 4, height = 4, units = 'in', res = 300)
brasil_plot  + scale_y_continuous(trans = 'log10') +
ylab("Total de casos confirmados\n(escala log)")
dev.off()
#brasil1$pais = rep("Brasil", 70)
library(ggplot2)
p <- ggplot(brasil1, aes(x = date3, y = Death, group = pais)) +
geom_line(aes(color = pais), size = 1) +
scale_color_manual(values = c("#000000")) +
geom_point(aes(color = pais), size = 1.5) +
theme_light() +
theme(axis.text.x = element_text(angle = 90)) #+
#scale_y_continuous(breaks = seq(0, 1200, 100))
brasil_obito <- p + scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-08", today()))) +
xlab("") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
labs(title = "Óbitos COVID-19 no Brasil",
caption = paste("IRRD/PE. Fonte: CIEVS/NUVRESP/SEVS/SES.
\n Dados atualizados em ", format(today(), "%d/%m/%Y.")))
brasil_obito
View(brasil1)
jpeg(paste(path, "covid-19_obitos_brasil.jpg", sep = ""),
width = 4, height = 4, units = 'in', res = 300)
brasil_obito +
scale_y_continuous(breaks = seq(0,max(brasil1$Death), 50)) +
ylab("Total de óbitos\n(escala linear)")
dev.off()
jpeg(paste(path, "covid-19_obitos_brasil_log.jpg", sep = ""),
width = 4, height = 4, units = 'in', res = 300)
brasil_obito +
scale_y_continuous(trans = 'log10') +
ylab("Total de óbitos\n(escala log)")
dev.off()
paises <- c("China", "Italy", "Iran", "Spain", "Germany", "US", "France", "Brazil")
countries <- filter(mergedCases, Country %in%  paises)
# Começando em 100 casos
countries2 <- filter(countries, Confirmed >=100)
# Reorganizando as datas
countries2 = countries2 %>%
mutate(date2 = as.POSIXct(as.character(Date), format = "%m/%d/%y"),
date3 = as.Date(date2))
# Criando uma variável de tempo em dias a partir do 100º caso
lista_paises <- list(NULL)
for(i in 1:length(paises)){
df <- filter(countries2, Country == paises[i])
t0 <- (sort(df$date3))[1]
df <- mutate(df, Time = as.numeric(date3 - t0))
lista_paises[[i]] <- df
}
names(lista_paises) <- paises
# Juntando numa única base de dados
paises100casos <- do.call(rbind, lista_paises)
# Colocando o nome dos países em ordem
class(paises100casos$Country)
paises100casos$Country2 = factor(paises100casos$Country,
levels = paises)
# Colocando o nome dos países em português
paises100casos <- paises100casos %>%
mutate(Países = if_else(Country == "Italy", "Itália",
if_else(Country == "Iran", "Irã",
if_else(Country == "Spain", "Espanha",
if_else(Country == "Germany",
"Alemanha",
if_else(Country == "Brazil", "Brasil", if_else(Country == "US", "Estados Unidos", if_else(Country == "France", "França", as.character(Country)))))))))
library(ggplot2)
p <- ggplot(paises100casos, aes(x = Time, y = Confirmed, group = Países)) +
geom_line(aes(color = Países)) +
geom_point(aes(color = Países)) +
xlab("Número de dias a partir do 100º caso") +
scale_x_continuous(breaks = seq(0,70,by=10)) +
labs(title = "COVID-19: Número acumulado de casos",
caption = paste("IRRD/PE. \n Fonte: OMS/CDC/Worldmeters/\nJohn Hopkins University(Sistema). Dados atualizados em ", format(today(), "%d/%m/%Y"))) +
theme(legend.title = element_blank())
p + theme_minimal()
jpeg(paste(path, "comparacao_brasil_paises.jpg"),
width = 6, height = 5, units = 'in', res = 300)
p + theme_minimal() +
ylab("Total de casos confirmados\n(escala linear)")
dev.off()
jpeg(paste(path,"comparacao_brasil_paises_escala_log.jpg"),
width = 6, height = 5, units = 'in', res = 300)
p + theme_minimal() +
scale_y_log10()  + ylab("Total de casos confirmados\n(escala log)")
dev.off()
setwd("~/Google Drive/Coronavirus/IRRD/codigos em R/python em r /03-04-2020")
setwd("~/Documents/GitHub/covid-19_Pernambuco/curvatura_ricci")
library(reticulate) #para rodar códigos em Python
library(readr)
library(ggplot2)
library(tidyr)
library(dplyr)
library(plotly)
# Local da versão do Python a ser utilizada
use_python('/opt/anaconda3/bin/python', required = TRUE)
py_run_file("Ricci.py")
# Carregando os csv's gerados
ricci_mundo <- read_csv("forman_ricci_mundial.csv")
ricci_brasil <- read_csv("forman_ricci_brasil.csv")
View(ricci_brasil)
class(forman_ricci_brasil$periodo)
### Mudando o formato das datas
ricci_brasil$periodo = as.Date.character(forman_ricci_brasil$periodo, format = "%d %b")
# Carregando os csv's gerados
ricci_mundo <- read_csv("forman_ricci_mundial.csv")
ricci_brasil <- read_csv("forman_ricci_brasil.csv")
### Mudando o formato das datas
ricci_brasil$periodo = as.Date.character(forman_ricci_brasil$periodo, format = "%d %b")
### Mudando o formato das datas
ricci_brasil$periodo = as.Date.character(ricci_brasil$periodo, format = "%d %b")
class(ricci_brasil$periodo)
write.csv(forman_ricci_brasil, "forman_ricci_brasil.csv")
write.csv(ricci_brasil, "forman_ricci_brasil.csv")
ricci_mundo$periodo = as.Date.character(ricci_mundo$periodo, format = "%d %b")
class(ricci_mundo$periodo)
write.csv(ricci_mundo, "forman_ricci_mundial.csv")
setwd("~/Documents/GitHub/covid-19_Pernambuco/predicoes")
library(reticulate) #para rodar códigos em Python
library(readr)
library(ggplot2)
library(tidyr)
library(dplyr)
library(plotly)
use_python('/opt/anaconda3/bin/python', required = TRUE)
#py_install("orca")
# Rodando
# Importante: mudar o diretório para onde se encontra o arquivo!
py_run_file("Fitting_curvature_.py")
# Carregando os csv's gerados
Casos_confirmados_Brazil_Fitting <- read_csv("Casos_confirmados_Brazil_Fitting.csv")
Casos_confirmados_Brazil_Fitting$Data = as.Date.character(Casos_confirmados_Brazil_Fitting$Data, format = "%d %b")
class(Casos_confirmados_Brazil_Fitting$Data)
write.csv(Casos_confirmados_Brazil_Fitting, "Casos_confirmados_Brazil_Fitting.csv")
Casos_confirmados_Pernambuco_Fitting <- read_csv("Casos_confirmados_Pernambuco_Fitting.csv")
Casos_confirmados_Pernambuco_Fitting$Data = as.Date.character(Casos_confirmados_Pernambuco_Fitting$Data, format = "%d %b")
class(Casos_confirmados_Pernambuco_Fitting$Data)
write.csv(Casos_confirmados_Pernambuco_Fitting, "Casos_confirmados_Pernambuco_Fitting.csv")
library(dplyr)
library(ggplot2)
library(readr)
pe_municipios <- read.csv('https://raw.githubusercontent.com/edneide/covid-19_Pernambuco/master/covid-19_Pernambuco.csv')
#pe_municipios <- read_delim("~/Google Drive/Coronavirus/IRRD/planilhas de pe/31-03-2020/recife_att_2020-03-31_22-59.csv",
#    ";", escape_double = FALSE, trim_ws = TRUE)
df <- pe_municipios[,-1]
names(df)
class(df$classificacao_final)
# Convertendo em character
df <- data.frame(lapply(df, as.character), stringsAsFactors=FALSE)
# Checando a classe
class(df$classificacao_final)
clasificacao = as.data.frame(table(df$classificacao_final))
#ggplot(df, aes(x = reorder(Freq, -Var1), y = Freq))
#ggplot(clasificacao, aes(x = Var1, y = Freq, fill = Var1))
plot_class = ggplot(clasificacao, aes(x = reorder(Var1, -Freq), y = Freq, fill = Var1)) +
geom_bar(stat = "identity", position = position_dodge()) +
geom_text(aes(label = Freq)) +
ggtitle("Classificação Final") +
xlab("") + ylab("Frequência")
plot_class + coord_flip() + theme(legend.position = "none")
table(df$classificacao_final)
table(df$classificacao_final)
as.data.frame(table(df$classificacao_final))
cenarios_pe = as.data.frame(table(df$classificacao_final))
cenarios_pe = as.data.frame(table(df$classificacao_final))
cenarios_pe
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
Cov_C <- read_csv("https://raw.githubusercontent.com/wcota/covid19br/master/cases-brazil-cities.csv",
col_types = cols(country = col_skip()))
#View(Cov_C)
Cov_D <- read_csv("https://raw.githubusercontent.com/wcota/covid19br/master/cases-brazil-states.csv",
col_types = cols(city = col_skip(), country = col_skip()))
#View(Cov_D)
Cov_E <- read_csv("https://raw.githubusercontent.com/wcota/covid19br/master/cases-brazil-total.csv",
col_types = cols(URL = col_skip(), country = col_skip()))
View(Cov_C)
View(Cov_D)
View(Cov_E)
df <- Cov_D
View(df)
pe <- filter(df, state == "PE")
View(pe)
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
Cov_C <- read_csv("https://raw.githubusercontent.com/wcota/covid19br/master/cases-brazil-cities.csv",
col_types = cols(country = col_skip()))
#View(Cov_C)
Cov_D <- read_csv("https://raw.githubusercontent.com/wcota/covid19br/master/cases-brazil-states.csv",
col_types = cols(city = col_skip(), country = col_skip()))
#View(Cov_D)
Cov_E <- read_csv("https://raw.githubusercontent.com/wcota/covid19br/master/cases-brazil-total.csv",
col_types = cols(URL = col_skip(), country = col_skip()))
df <- Cov_D
pe <- filter(df, state == "PE")
# Gráfico
p <- ggplot(pe, aes(x = date, y = totalCases, group = state)) +
geom_line(aes(color = state), size = 1) +
scale_color_manual(values = c("#cc3300")) +
geom_point(aes(color = state), size = 1.5) + theme_light() + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Casos confirmados COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-12", today()))) +
xlab("") +
theme(legend.title = element_blank(),
legend.position = "bottom")
p
path <- "/Users/edneideramalho/Google Drive/Coronavirus/IRRD/Informes e relatórios/graficos 05-04-2020/"
# linear
jpeg(paste(path, "covid-19_pernambuco_confirmados.jpg", sep = ""),
width = 4, height = 4, units = 'in', res = 300)
p +
scale_y_continuous(breaks = seq(0,max(pe$totalCases),20)) +
ylab("Total de casos confirmados\n(escala linear)")
dev.off()
# log
jpeg(paste(path, "covid-19_pernambuco_confirmados_escala_log.jpg", sep = ""),
width = 4, height = 4, units = 'in', res = 300)
p + scale_y_continuous(trans = 'log10') +
ylab("Total de casos confirmados\n(escala log)")
dev.off()
library(ggdark)
plot_newcases <- ggplot(pe, aes(x = date, y = newCases, group = state)) +
geom_bar(stat="identity", color = "white", fill = "yellow", alpha = 0.9) +
geom_text(aes(label=newCases), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-11", today()))) +
labs(title = "Número de novos casos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos casos")
plot_newcases
View(pe)
mortes = pe$deaths
mortes2 = vector("numeric", length(mortes))
day1 = pe$date[1]
pe %>% mutate(new.deaths = ifelse(date == day1, NA, deaths - lag(deaths, k=1)))
day1 = pe$date[1]
pe = pe %>% mutate(new.deaths = ifelse(date == day1, NA, deaths - lag(deaths, k=1)))
View(pe)
plot_newdeaths <- ggplot(pe, aes(x = date, y = new.deaths, group = state)) +
geom_bar(stat="identity", color = "white", fill = "blue", alpha = 0.9) +
geom_text(aes(label=newCases), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-11", today()))) +
labs(title = "Número de novos óbitos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos casos")
plot_newdeaths
plot_newdeaths <- ggplot(pe, aes(x = date, y = new.deaths, group = state)) +
geom_bar(stat="identity", color = "white", fill = "blue", alpha = 0.9) +
geom_text(aes(label=new.deaths), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-11", today()))) +
labs(title = "Número de novos óbitos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos casos")
plot_newdeaths
plot_newdeaths <- ggplot(pe, aes(x = date, y = new.deaths, group = state)) +
geom_bar(stat="identity", color = "white", fill = "blue", alpha = 0.9) +
geom_text(aes(label=new.deaths), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-12", today()))) +
labs(title = "Número de novos óbitos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos casos")
plot_newdeaths
plot_newdeaths <- ggplot(pe, aes(x = date, y = new.deaths, group = state)) +
geom_bar(stat="identity", color = "white", fill = "blue", alpha = 0.9) +
geom_text(aes(label=new.deaths), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-13", today()))) +
labs(title = "Número de novos óbitos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos casos")
plot_newdeaths
news = pe %>% select(date, new.deaths, newCases)
View(news)
news2 = melt(news, id = "date")
View(news2)
plot_deaths <- ggplot(pe, aes(x = date, y = deaths, group = state)) +
geom_bar(stat="identity", color = "white", fill = "blue", alpha = 0.9) +
geom_text(aes(label=new.deaths), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-13", today()))) +
labs(title = "Óbitos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos casos")
plot_deaths
plot_deaths <- ggplot(pe, aes(x = date, y = deaths, group = state)) +
geom_bar(stat="identity", color = "white", fill = "blue", alpha = 0.9) +
geom_text(aes(label=deaths), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-13", today()))) +
labs(title = "Óbitos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos casos")
plot_deaths
ggplot(data=news2,
aes(x=date, y=value, colour=variable)) +
geom_bar()
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "indentity")
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity")
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(label=value), vjust=1.6, color="white", size=3.5)
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(label=value), vjust=1.7, color="white", size=3.5)
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(label=value), vjust=1.9, color="white", size=3.5)
news2 = new2 %>% mutate(ypos = cumsum(value))
news2 = news2 %>% mutate(ypos = cumsum(value))
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = ypos, label=value), vjust=1.9, color="white", size=3.5)
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = ypos, label=value), vjust=1.9, color="white", size=3.5)
plot_newdeaths <- ggplot(pe, aes(x = date, y = new.deaths, group = state)) +
geom_bar(stat="identity", color = "white", fill = "blue", alpha = 0.9) +
geom_text(aes(label=new.deaths), position=position_dodge(width=0.9), vjust=-0.25)+
dark_theme_gray() +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(date_breaks = "1 days", date_labels = "%b %d",
limits = as.Date(c("2020-03-13", today()))) +
labs(title = "Número de novos óbitos COVID-19",
subtitle = "Pernambuco",
caption = paste("IRRD/PE. Fonte: Secretaria de Saúde de Pernambuco\n Dados atualizados em ", format(as.Date(today()), "%d/%m/%Y"))) +
xlab("Data") + ylab("Novos óbitos")
plot_newdeaths
jpeg(paste(path, "novos_obitos_pe.jpg"),
width = 6, height = 5, units = 'in', res = 300)
plot_newdeaths
dev.off()
news = pe %>% select(date, deaths, totalCases)
news2 = melt(news, id = "date")
news2 = news2 %>% mutate(ypos = cumsum(value))
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = ypos, label=value), vjust=1.9, color="white", size=3.5)
View(news2)
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity")
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value, label=value), vjust=1.9, color="white", size=3.5)
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+2, label=value), vjust=1.9, color="white", size=3.5)
ggplot(data=news2,aes(fill = variable, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+10, label=value), vjust=1.9, color="white", size=3.5)
news = pe %>% select(date, deaths, totalCases)
news2 = melt(news, id = "date")
news2$variable2 = factor(news2$variable2, levels = c("deaths", "totalCases"))
news2$variable2 = factor(news2$variable, levels = c("deaths", "totalCases"))
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+10, label=value), vjust=1.9, color="white", size=3.5)
news2$variable2 = factor(news2$variable, levels = c("totalCases", "deaths"))
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+10, label=value), vjust=1.9, color="white", size=3.5)
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+10, label=value), vjust=1.9, color="black", size=3.5)
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value, label=value), vjust=1.9, color="black", size=3.5)
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+2, label=value), vjust=1.9, color="black", size=3.5)
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+10, label=value), vjust=1.9, color="black", size=3.5)
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+20, label=value), vjust=1.9, color="black", size=3.5)
ggplot(data=news2,aes(fill = variable2, x=date, y=value)) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(y = value+15, label=value), vjust=1.9, color="black", size=3.5)
